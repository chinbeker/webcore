!function(){"use strict";class ServiceManager{static#e=null;#t=new Map;#n=new Map;constructor(){if(ServiceManager.#e)return ServiceManager.#e;ServiceManager.#e=this}#s(e){const t=e.depends.map(e=>this.get(e));return new e.service(...t)}get(e){if(!this.has(e))throw new Error(`Service '${e}' not registered`);const t=this.#t.get(e);return t.singleton?(this.#n.has(e)||this.#n.set(e,this.#s(t)),this.#n.get(e)):this.#s(t)}has(e){return this.#t.has(e)}serviceNames(){return Array.from(this.#t.keys())}register(e,t,n={}){if("string"==typeof e&&"object"==typeof n){const s={singleton:!1,depends:[],...n};this.#t.set(e,{service:t,...s})}return this}addSingleton(e,t,n=[]){return this.register(e,t,{singleton:!0,depends:n})}addTransient(e,t,n=[]){return this.register(e,t,{singleton:!1,depends:n})}dispose(){this.#n.forEach(e=>{"function"==typeof e.dispose&&e.dispose()}),this.#t.clear(),this.#n.clear()}}class Configuration{#r=new Map;constructor(){}set(e,t){return this.#r.set(e,t),this}has(e){return this.#r.has(e)}get(e){return this.#r.get(e)}delete(e){return this.#r.has(e)&&this.#r.delete(e),this}clear(){return this.#r.clear(),this}getSection(e){return this}}class ApplicationBuilder{#i=null;#o;#a;#c;#t=[];constructor(){this.#o=new Configuration,this.#a=new ServiceManager}setConfig(e,t){return this.#o.set(e,t),this}addService(e,t,n={}){return this.#a.register(e,t,n),this.#t.push(e),this}build(){const e=new Application(this.#o,this.#a,this.#c);for(const t of this.#t)e[t]=this.#a.get(t);return e}}class Application{static#e=null;configuration=null;services=null;constructor(e,t){if(Application.#e)return Application.#e;this.configuration=e,this.services=t,Application.#e=this}static createBuilder(){return new ApplicationBuilder}getConfig(e){return this.configuration.get(e)}getService(e){return this.services.resolve(e)}hasService(e){return this.services.has(e)}getRegisteredServices(){return this.services.getRegisteredServices()}run(){Object.hasOwn(this,"initial")&&this.initial.execute()}}class InitialService{static instance=null;default=null;open=null;loaded=null;executed=!1;constructor(){if(InitialService.instance)return InitialService.instance;InitialService.instance=this,self.addEventListener("DOMContentLoaded",()=>{try{"function"==typeof this.loaded&&this.loaded(),this.executed=!0,this.loaded=null}catch(e){return!1}},{once:!0})}add(e){"function"==typeof e&&this.open.push(e)}execute(){if(!this.executed&&"function"==typeof this.default)try{"function"==typeof this.default&&this.default(),"function"==typeof this.load&&this.open(),this.executed=!0,this.default=null,this.load=null}catch(e){return!1}return!0}}class LayoutService{static#e=null;root=null;font=Object.create(null);constructor(){if(LayoutService.#e)return LayoutService.#e;this.root=document.documentElement,this.setupFontScaling(),this.setupUserExperience(),LayoutService.#e=this}get fontSize(){return parseFloat(getComputedStyle(this.root).getPropertyValue("font-size"))}setupFontScaling(){const e=this.root;if(!e.classList.contains("dync")){const t=screen.orientation;this.font.base=28.57,this.font.initial=parseFloat(getComputedStyle(e).getPropertyValue("font-size"))||15.4;const n=()=>{0==screen.orientation.angle||180==screen.orientation.angle?this.root.classList.add("portrait"):this.root.classList.remove("portrait")},s=()=>{0==screen.orientation.angle||180==screen.orientation.angle?(this.root.style.fontSize=this.font.portrait,this.root.classList.add("portrait")):(this.root.style.fontSize=this.font.landscape,this.root.classList.remove("portrait"))},r=screen.width/this.font.initial<this.font.base||screen.height/this.font.initial<this.font.base;return!t.type.startsWith("p")||0!=t.angle&&180!=t.angle?!t.type.startsWith("l")||90!=t.angle&&270!=t.angle||(r?top.innerWidth>screen.width?(this.font.portrait=top.innerWidth/this.font.base+"px",this.font.landscape=top.innerWidth/screen.width*(screen.height/this.font.base)+"px",e.style.fontSize=this.font.landscape,t.onchange=s):(this.font.portrait=screen.height/this.font.base+"px",e.style.fontSize=this.font.portrait,t.onchange=n):t.onchange=n):(e.classList.add("portrait"),r?(this.font.portrait=top.innerWidth/this.font.base+"px",e.style.fontSize=this.font.portrait,top.innerWidth>screen.width?(this.font.landscape=top.innerWidth/screen.height*(screen.width/this.font.base)+"px",t.onchange=s):t.onchange=n):t.onchange=n),!0}return!1}setupUserExperience(){this.root.classList.contains("ban")&&(this.root.oncontextmenu=e=>(e.preventDefault(),e.stopPropagation(),!1));const e=function(){};return document.addEventListener("touchstart",e,{passive:!0}),window.onbeforeunload=()=>{document.removeEventListener("touchstart",e)},!0}}class ViewportService{static#e=null;#l=null;#h=[];#u=!1;constructor(){if(ViewportService.#e)return ViewportService.#e;this.#l=top.matchMedia("(orientation: landscape)"),this.#l.onchange=()=>{this.execute()};const e=()=>{this.#l.matches?document.documentElement.classList.remove("portrait"):document.documentElement.classList.add("portrait")},t=screen.orientation;(document.documentElement.classList.contains("dync")||t.type.startsWith("p")&&(90==t.angle||270==t.angle)||t.type.startsWith("l")&&(0==t.angle||180==t.angle))&&this.add(e),e(),ViewportService.#e=this}get length(){return this.#h.length}get count(){return this.#h.length}get landscape(){return this.#l.matches}get portrait(){return!this.#l.matches}get orientation(){return this.#l.matches?"landscape":"portrait"}add(e){return this.#u||"function"!=typeof e||(this.remove(e),this.#h.push(e)),this}addBatch(e){if(!this.#u&&Array.isArray(e))for(const t of e)this.add(t);return this}has(e){return"function"==typeof e&&-1!==this.#h.indexOf(e)}async execute(){if(this.#u)return!1;this.#u=!0;for(const t of this.#h)try{await Promise.resolve(t())}catch(e){}return this.#u=!1,!0}remove(e){if(!this.#u&&"function"==typeof e){const t=this.#h.indexOf(e);if(-1!==t)return this.#h.splice(t,1),!0}return!1}removeAt(e){return!this.#u&&"number"==typeof e&&e>=0&&e<this.#h.length&&(this.#h.splice(e,1),!0)}clear(){return this.#h=[],!0}destroy(){this.#l.onchange=null,this.#h=[],Viewport.#e=null}}class RouterService{static#e=null;#p=null;#d=null;constructor(){if(RouterService.#e)return RouterService.#e;top.history.replaceState(!0,null,location.origin+location.pathname);const e=Object.create(null);e.top=e=>{e.preventDefault(),top.location.replace(e.currentTarget.dataset.href)},e.parent=e=>{e.preventDefault(),parent.location.replace(e.currentTarget.dataset.href)},e.blank=e=>{e.preventDefault(),self.open(e.currentTarget.dataset.href,"_blank")},e.assign=e=>{e.preventDefault(),location.assign(e.currentTarget.dataset.href)},e.replace=e=>{e.preventDefault(),location.replace(e.currentTarget.dataset.href)},this.#p=e,RouterService.#e=this,document.documentElement.classList.contains("webcore")&&top.addEventListener("DOMContentLoaded",()=>{this.init(),this.anchor(document.body)},{once:!0})}init(){this.#p.frames=Object.create(null);const e=top.frames.length;for(let t=0;t<e;t++){const e=Object.create(null);e.frame=top.frames[t],e.assign=t=>{t.preventDefault(),e.frame.location.assign(t.currentTarget.dataset.href)},e.replace=t=>{t.preventDefault(),e.frame.location.replace(t.currentTarget.dataset.href)};const n=top.frames[t].name||"view";this.#p.frames[n]=e}}anchor(e){return e.querySelectorAll("a[data-href]").forEach(e=>{const t=!!e.hasAttribute("data-target")&&e.dataset.target.trim(),n=!!e.hasAttribute("data-iframe")&&e.dataset.iframe.trim();if(t){if("top"===t)return e.onclick=this.#p.top,!0;if("parent"===t)return e.onclick=this.#p.parent,!0;if("blank"===t)return e.onclick=this.#p.blank,!0}return n&&Object.hasOwn(this.#p.frames,n)?t&&"self"===t?(e.onclick=this.#p.frames[n].replace,!0):(e.onclick=this.#p.frames[n].assign,!0):t&&"self"===t?(e.onclick=this.#p.replace,!0):(e.onclick=this.#p.assign,!0)}),!0}}class Component{name=null;componentClass=null;template=null;styles=null;props=[];constructor(e,t){this.name=e.name,this.template=e.template,this.styles=e.styles,this.props=e.props,this.componentClass=t}createInstance(){return new this.componentClass}getComponentClass(){return this.componentClass}}class ComponentBuilder{#f="core-element";#m="open";#g=null;#v="<div><slot></slot></div>";#y=[];#b=Object.create(null);#w=[];constructor(){}name(e){return e&&"string"==typeof e&&(e.includes("-")||(e=`core-${e}`),this.#f=e),this}template(e){return e&&"string"==typeof e&&e&&(this.#v=e.replace(/\n\s*/g,"").replace(/>\s+</g,"><").trim()),this}styles(e){return e&&"string"==typeof e&&(this.#g=e.replace(/\n\s*/g,"").replace(/\s*{\s*/g,"{").replace(/\s*}\s*/g,"}").replace(/\s*:\s*/g,":").replace(/\s*;\s*/g,";").replace(/;\s*}/g,"}").trim()),this}mode(e="open"){if(!["open","closed"].includes(e))throw new Error('Shadow DOM mode must be either "open" or "closed"');return this.#m=e,this}inject(...e){if(!Array.isArray(e))throw new Error("Component service inject must be a array value");return this.#w.push(...e),this}methods(e={}){if("object"!=typeof e||null===e)throw new Error("Methods parameter must be a valid object");for(const t of Object.keys(e))this.#b[t]=e[t];return this}attributes(e=[]){if(!Array.isArray(e))throw new Error("Observed attributes must be provided as an array");return this.#y=e,this}create(e){if("function"!=typeof e)throw new Error("Create callback must be a function");return this.#b.create=e,this}onConnected(e){if("function"!=typeof e)throw new Error("Connected callback must be a function");return this.#b.onConnected=e,this}onAttributeChanged(e){if("function"!=typeof e)throw new Error("Attribute changed callback must be a function");return this.#b.onAttributeChanged=e,this}onAdopted(e){if("function"!=typeof e)throw new Error("Adopted callback must be a function");return this.#b.onAdopted=e,this}onDisconnected(e){if("function"!=typeof e)throw new Error("Disconnected callback must be a function");return this.#b.onDisconnected=e,this}build(){const e=Object.create(null);e.name=this.#f,e.template=this.#v,e.styles=this.#g,e.props=this.#y,e.mode=this.#m;const t=class Builder extends HTMLElement{static template=null;static styles=null;name=e.name;props=e.props;shadow=null;state=Object.create(null);element=Object.create(null);root=null;constructor(){super();const t=this.attachShadow({mode:e.mode});if(e.styles)if(Builder.styles)t.adoptedStyleSheets=Builder.styles;else{const n=new CSSStyleSheet;n.replaceSync(e.styles),Builder.styles=[n],t.adoptedStyleSheets=Builder.styles}if(Builder.template)this.root=Builder.template.cloneNode(!0);else{const t=document.createRange().createContextualFragment(e.template);Builder.template=t,this.root=t.cloneNode(!0)}t.appendChild(this.root),this.shadow=t,this.root=t.firstElementChild,"function"==typeof this.create&&this.create()}attributeChangedCallback(e,t,n){"function"==typeof this.onAttributeChanged&&this.onAttributeChanged(e,t,n)}connectedCallback(){"function"==typeof this.onConnected&&this.onConnected(this)}adoptedCallback(){"function"==typeof this.onAdopted&&this.onAdopted(this)}disconnectedCallback(){"function"==typeof this.onDisconnected&&this.onDisconnected(this)}selector(e){return this.shadow.querySelector(e)}service(e){return Object.hasOwn(this.services,e)?this.services[e]:null}};if(this.#w.length>0){e.services=Object.create(null);for(const t of this.#w)e.services[t]=n.services.get(t);t.prototype.services=e.services}for(const n of Object.keys(this.#b))t.prototype[n]=this.#b[n];Array.isArray(e.props)&&e.props.length>0&&Object.defineProperty(t,"observedAttributes",{get:()=>e.props,configurable:!0,enumerable:!0});return new Component(e,t)}}class ComponentEvent{static#e=null;#p=new Map;constructor(){if(ComponentEvent.#e)return ComponentEvent.#e;ComponentEvent.#e=this}on(e,t={}){return!("string"!=typeof e||!(e=e.trim())||"object"!=typeof t)&&(null!==Object.getPrototypeOf(t)&&(t=Object.assign(Object.create(null),t)),this.off(e),this.#p.set(e,t),!0)}has(e){return"string"==typeof e&&((e=e.trim())&&this.#p.has(e))}get(e,t=null){if("string"!=typeof e)throw new Error("The component name must be of string type.");if((e=e.trim())&&this.has(e)){const n=this.#p.get(e);if("object"==typeof n){if("string"!=typeof t)return n;if((t=t.trim())&&Object.hasOwn(n,t))return n[t]}}return null}off(e){return!("string"!=typeof e||!(e=e.trim())||!this.has(e))&&(this.#p.delete(e),!0)}clear(){return this.#p.clear(),!0}}class ComponentService{static#e=null;#E=new Map;#S=null;constructor(){if(ComponentService.#e)return ComponentService.#e;this.#S=new ComponentEvent,ComponentService.#e=this}event(e){return this.#S.get(e)}on(e,t){return this.#S.on(e,t)}createBuilder(){return new ComponentBuilder}async load(e){if("string"!=typeof e)return null;const t=new URL(e,location.href);try{const e=(await import(t.href)).default;return this.register(e),new e.componentClass}catch(n){return null}}has(e){return"string"==typeof e&&(e.includes("-")||(e=`core-${e}`),this.#E.has(e))}get(e){return"string"!=typeof e?null:(e.includes("-")||(e=`core-${e}`),this.has(e)?this.#E.get(e).createInstance():null)}getClass(e){return"string"!=typeof e?null:(e.includes("-")||(e=`core-${e}`),this.has(e)?this.#E.get(e).getComponentClass():null)}register(e,t=null){if(!t&&!e.name)return this;const n=t||e.name;if(!Object.hasOwn(e,"componentClass"))return this;if(this.has(n))return this;try{return customElements.define(n,e.componentClass),this.#E.set(n,e),this}catch(s){return this}}registerAll(e){return"object"!=typeof e||null===e||Object.entries(e).forEach(([e,t])=>{this.register(t,e)}),this}unregister(e){return!!this.has(e)&&(this.#E.delete(e),!0)}clear(){this.#E.size;return this.#E.clear(),this.#S.clear(),this}}class ReactiveElement{#C=null;#O="";constructor(e,t){e instanceof HTMLElement?this.#C=e:this.#C=document.createElement("div"),t&&"string"==typeof t&&(this.#C.textContent=t,this.#O=t)}get element(){return this.#C}get value(){return this.#O}set value(e){"function"==typeof this.onchange&&this.#O!==e&&this.onchange(e,this.#O,this.#C),this.#O=e,this.#C.textContent=e}mount(e){if("string"==typeof e){const t=document.querySelector(e);t&&t.append(this.#C)}else e instanceof HTMLElement&&e.append(this.#C);return this}unmount(){return this.#C.remove(),this}}class ReactiveStore{#k=null;constructor(e=null){const t=Object.create(null);t.value=e,this.#k=new Proxy(t,{get:(e,t)=>e.value,set:(e,t,n)=>("function"==typeof this.onchange&&this.onchange(n,e.value),e.value=n,!0)})}get value(){return this.#k.value}set value(e){this.#k.value=e}}class ReactiveService{static#e=null;constructor(){if(ReactiveService.#e)return ReactiveService.#e;ReactiveService.#e=this}element(e="div",t){if(e instanceof HTMLElement)return new ReactiveElement(e,t);try{"string"!=typeof e&&(e="div");const n=document.createElement(e);return new ReactiveElement(n,t)}catch{return new ReactiveElement(document.createElement("div"),t)}}store(e){return new ReactiveStore(e)}}class EventBuilder{element=null;handlers=Object.create(null);options=Object.create(null);empty=Object.create(null);constructor(e){if(!(e instanceof HTMLElement))throw new Error("Event target must be an HTMLElement");this.element=e}on(e,t,n=null){if("string"!=typeof e)throw new Error("Event name must be a string");if("function"!=typeof t)throw new Error("Event handler must be a function");return this.handlers[e]=t,this.options[e]=n||this.empty,this}has(e){return"string"==typeof e&&Object.hasOwn(this.handlers,e)}get(e){return this.has(e)?this.handlers[e]:null}remove(e){return this.has(e)&&(this.handlers[e]=null,Reflect.deleteProperty(this.handlers,e),Object.hasOwn(this.options,e)&&(this.options[e]=null,Reflect.deleteProperty(this.options,e))),this}once(e,t,n=null){return n||(n=this.empty),n.once=!0,this.on(e,t,n)}click(e,t){return this.on("click",e,t)}submit(e,t){return this.on("submit",e,t)}reset(e,t){return this.on("reset",e,t)}invalid(e,t){return this.on("invalid",e,t)}resize(e,t){return this.on("resize",e,t)}scroll(e,t){return this.on("scroll",e,t)}focus(e,t){return this.on("focus",e,t)}blur(e,t){return this.on("blur",e,t)}change(e,t){return this.on("change",e,t)}input(e,t){return this.on("input",e,t)}keydown(e,t){return this.on("keydown",e,t)}toggle(e,t){return this.on("toggle",e,t)}show(e,t){return this.on("show",e,t)}open(e,t){return this.on("open",e,t)}close(e,t){return this.on("close",e,t)}error(e,t){return this.on("error",e,t)}message(e,t){return this.on("message",e,t)}dblclick(e,t){return this.on("dblclick",e,t)}contextmenu(e,t){return this.on("contextmenu",e,t)}hover(e,t,n){return this.on("mouseenter",e,n),this.on("mouseleave",t,n),this}}class EventService{static#e=null;#p=new WeakMap;constructor(){if(EventService.#e)return EventService.#e;EventService.#e=this}#j=e=>this.#L(e);target(e,t,n=10){if(!(e instanceof Event))return null;if(!e.target||!e.currentTarget)return null;let s=e.target;const r=e.currentTarget;if("string"!=typeof t)return s;if(!(t=t.trim().toUpperCase()))return s;if(s===r)return r.nodeName===t?s:null;if("string"==typeof t){let e=0;for(;e<n&&s!=r;){if(s.nodeName===t)return s;if(!s.parentElement)return null;s=s.parentElement,e++}}return null}has(e,t=null){if(!(e instanceof HTMLElement))return!1;return!!this.#p.has(e)&&("string"!=typeof t||Object.hasOwn(this.#p.get(e),t))}on(e,t,n,s){if(!(e instanceof HTMLElement))throw new Error("Event target must be an HTMLElement");if("string"!=typeof t)throw new Error("Event name must be a string");if("function"!=typeof n)throw new Error("Event handler must be a function");let r=null;try{return this.#p.has(e)?(r=this.#p.get(e),Object.hasOwn(r,t)||e.addEventListener(t,this.#j,s)):(r=Object.create(null),this.#p.set(e,r),e.addEventListener(t,this.#j,s)),r[t]=n,this}catch(i){return this}}createBuilder(e){return new EventBuilder(e)}register(e){try{if(e instanceof EventBuilder){this.#p.set(e.element,e.handlers);for(const t of Object.keys(e.handlers))e.element.addEventListener(t,this.#j,e.options[t])}}catch(t){return!1}}once(e,t,n,s={}){try{return s.once=!0,e.addEventListener(t,n,s),!0}catch(r){return!1}}#L(e){const t=e.type;let n=null;if(this.has(e.currentTarget,t)?n=this.#p.get(e.currentTarget)[t]:this.has(e.target,t)&&(n=this.#p.get(e.target)[t]),"function"==typeof n)try{return n(e)}catch(s){return!1}return!1}emit(e,t){if(this.has(e,t)){const s=this.#p.get(e)[t];try{return s()}catch(n){return!1}}return!1}remove(e,t=null){if(this.has(e)){let n=this.#p.get(e);if("string"==typeof t){if(!Object.hasOwn(n,t))return this;n[t]=null,Reflect.deleteProperty(n,t),e.removeEventListener(t,this.#j),0===Object.keys(n).length&&this.#p.delete(e)}else{for(const t of Object.keys(n))n[t]=null,e.removeEventListener(t,this.#j);n=null,this.#p.delete(e)}}return this}debounce(e,t=300,n=!1){let s=null;return function(...r){const i=this;s&&clearTimeout(s),n&&!s&&e.apply(i,r),s=setTimeout(()=>{s=null,n||e.apply(i,r)},t)}}throttle(e,t=300,n=!0){let s=null,r=0;return function(...i){const o=this,a=Date.now(),c=t-(a-r);s&&(clearTimeout(s),s=null),c<=0?(e.apply(o,i),r=a):n&&!s&&(s=setTimeout(()=>{e.apply(o,i),r=Date.now(),s=null},c))}}destroy(){this.#p=new WeakMap}}const e=Application.createBuilder(),t=[{name:"initial",service:InitialService},{name:"layout",service:LayoutService},{name:"viewport",service:ViewportService},{name:"router",service:RouterService},{name:"component",service:ComponentService},{name:"reactive",service:ReactiveService},{name:"event",service:EventService}];for(const s of t)e.addService(s.name,s.service,{singleton:!0});const n=e.build();n.run(),self.app=n}();