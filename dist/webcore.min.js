!function(){"use strict";class e{#e=new Map;#t=new Map;constructor(){}#s(e){const t=e.dependencies.map(e=>this.resolve(e));return new e.implementation(...t)}resolve(e){if(!this.has(e))throw new Error(`Service '${e}' not registered`);const t=this.#e.get(e);return t.singleton?(this.#t.has(e)||this.#t.set(e,this.#s(t)),this.#t.get(e)):this.#s(t)}get(e){return this.Resolve(e)}has(e){return this.#e.has(e)}getRegisteredServices(){return Array.from(this.#e.keys())}register(e,t,s={}){const n={singleton:!1,dependencies:[],...s};return this.#e.set(e,{implementation:t,...n}),this}destroy(){this.#t.forEach(e=>{"function"==typeof e.destroy&&e.destroy()}),this.#e.clear(),this.#t.clear()}}class t{#n=new Map;constructor(){}set(e,t){return this.#n.set(e,t),this}has(e){return this.#n.has(e)}get(e){return this.#n.get(e)}delete(e){return this.#n.has(e)&&this.#n.delete(e),this}clear(){return this.#n.clear(),this}getSection(e){}}class s{#r=new Map;constructor(){}get name(){return this.constructor.name}install(e,t={}){throw new Error('"install" method must be implemented by subclass')}uninstall(e){throw new Error('"uninstall" method must be implemented by subclass')}onstart(){}onstop(){}use(e,t={}){const s=e.name||e.constructor.name;if(this.#r.has(s))return this;if("function"==typeof e.install)e.install(this,t);else{if("function"!=typeof e)throw new Error("\u63d2\u4ef6\u5fc5\u987b\u63d0\u4f9b install \u65b9\u6cd5\u6216\u662f\u4e00\u4e2a\u51fd\u6570");e(this,t)}return this.#r.set(s,{instance:e,options:t,installedAt:new Date}),this}unuse(e){if(!this.#r.has(e))return this;const t=this.#r.get(e);return"function"==typeof t.instance.uninstall&&t.instance.uninstall(this),this.#r.delete(e),this}}class n{name=null;componentClass=null;template=null;styles=null;props=[];constructor(e,t){this.name=e.name,this.template=e.template,this.styles=e.styles,this.props=e.props,this.componentClass=t}createInstance(){return new this.componentClass}getComponentClass(){return this.componentClass}}class r{#i="my-element";#o="open";#c=null;#a="<div><slot></slot></div>";#l=[];#h=Object.create(null);#u=[];constructor(){}name(e){if("string"!=typeof e)throw new Error("Component name must be a string value");if(!e.includes("-"))throw new Error("Custom element names must contain a hyphen according to Web Components specification");return this.#i=e,this}template(e){if("string"!=typeof e)throw new Error("Component template must be a string value");return this.#a=e.replace(/\n\s*/g,"").replace(/>\s+</g,"><").trim(),this}styles(e){if("string"!=typeof e)throw new Error("Component styles must be a string value");return this.#c=e.replace(/\n\s*/g,"").replace(/\s*{\s*/g,"{").replace(/\s*}\s*/g,"}").replace(/\s*:\s*/g,":").replace(/\s*;\s*/g,";").replace(/;\s*}/g,"}").trim(),this}mode(e="open"){if(!["open","closed"].includes(e))throw new Error('Shadow DOM mode must be either "open" or "closed"');return this.#o=e,this}inject(...e){if(!Array.isArray(e))throw new Error("Component service inject must be a array value");return this.#u.push(...e),this}methods(e={}){if("object"!=typeof e||null===e)throw new Error("Methods parameter must be a valid object");for(const t of Object.keys(e))this.#h[t]=e[t];return this}attributes(e=[]){if(!Array.isArray(e))throw new Error("Observed attributes must be provided as an array");return this.#l=e,this}create(e){if("function"!=typeof e)throw new Error("Create callback must be a function");return this.#h.create=e,this}onConnected(e){if("function"!=typeof e)throw new Error("Connected callback must be a function");return this.#h.onConnected=e,this}onAttributeChanged(e){if("function"!=typeof e)throw new Error("Attribute changed callback must be a function");return this.#h.onAttributeChanged=e,this}onAdopted(e){if("function"!=typeof e)throw new Error("Adopted callback must be a function");return this.#h.onAdopted=e,this}onDisconnected(e){if("function"!=typeof e)throw new Error("Disconnected callback must be a function");return this.#h.onDisconnected=e,this}build(){const e=Object.create(null);if(e.name=this.#i,e.template=this.#a,e.styles=this.#c,e.props=this.#l,e.mode=this.#o,e.services=new Map,this.#u.length>0)for(const s of this.#u)e.services.set(s,app.services.resolve(s));const t=class t extends HTMLElement{static template=null;static styles=null;#e=e.services;name=e.name;props=e.props;root=null;constructor(){super();const s=this.attachShadow({mode:e.mode});if(e.styles)if(t.styles)s.adoptedStyleSheets=t.styles;else{const n=new CSSStyleSheet;n.replaceSync(e.styles),t.styles=[n],s.adoptedStyleSheets=t.styles}if(t.template)this.root=t.template.cloneNode(!0);else{const s=document.createRange().createContextualFragment(e.template);t.template=s,this.root=s.cloneNode(!0)}s.appendChild(this.root),this.root=s,"function"==typeof this.create&&this.create()}attributeChangedCallback(e,t,s){"function"==typeof this.onAttributeChanged&&this.onAttributeChanged(e,t,s)}connectedCallback(){"function"==typeof this.onConnected&&this.onConnected(this)}adoptedCallback(){"function"==typeof this.onAdopted&&this.onAdopted(this)}disconnectedCallback(){"function"==typeof this.onDisconnected&&this.onDisconnected(this)}service(e){if(!this.#e.has(e))throw new Error(`Service "${e}" is not injected`);return this.#e.get(e)}services(...e){return e.map(e=>this.service(e))}hasService(e){return this.#e.has(e)}get injectedServices(){return Array.from(this.#e.keys())}};for(const s of Object.keys(this.#h))t.prototype[s]=this.#h[s];Array.isArray(e.props)&&e.props.length>0&&Object.defineProperty(t,"observedAttributes",{get:()=>e.props,configurable:!0,enumerable:!0});return new n(e,t)}}class i{static#p=null;#m=new Map;constructor(){if(i.#p)return i.#p;i.#p=this}static createBuilder(){return new r}has(e){return this.#m.has(e)}get(e){if(!this.has(e))throw new Error("Component not registered, please register first");return this.#m.get(e).createInstance()}register(e,t=null){const s=t||e.name;try{return customElements.define(s,e.getComponentClass()),this.#m.set(s,e),this}catch(n){throw new Error(`Failed to register component "${s}": ${n.message}`)}}registerAll(e){if("object"!=typeof e||null===e)throw new Error("Components must be provided as an object");return Object.entries(e).forEach(([e,t])=>{this.register(t,e)}),this}unregister(e){return!!this.has(e)&&(this.#m.delete(e),!0)}clear(){this.#m.size;return this.#m.clear(),this}}class o{application=null;configuration=null;services=null;plugins=null;components=null;constructor(){this.application=new c,this.configuration=new t,this.services=new e,this.plugins=new s,this.initialize()}initialize(){}setConfig(e,t){return this.configuration.set(e,t),this}addService(e,t){return this.services.register(e,t),this}build(){return this.application.configuration=this.configuration,this.application.services=this.services,this.application.plugins=this.plugins,this.application}addComponentService(){return this.services.register("Component",i,{singleton:!0}),this.application.component=this.services.resolve("Component"),this}}class c{static Instance=null;configuration=null;services=null;plugins=null;constructor(){if(c.Instance)return c.Instance;c.Instance=this}static createBuilder(){return new o}getConfig(e){return this.configuration.get(e)}getService(e){return this.services.resolve(e)}hasService(e){return this.services.has(e)}getRegisteredServices(){return this.services.getRegisteredServices()}run(){}}const a=new r;a.name("my-welcome").template("<div>\n            <h1><span>Welcome</span></h1>\n        </div>").styles("h1 {\n            font-size: 5em;\n            line-height: 5em;\n            text-align: center;\n            color: red;\n        }").attributes(["content"]),a.methods({create(){const e=this.root.querySelector("span");e.onclick=()=>{e.textContent="Hello World"}},mount(e){e.append(this)}}),a.onAttributeChanged((e,t,s)=>{});const l=a.build(),h=c.createBuilder();h.addComponentService();const u=h.build();u.component.register(l),u.run(),self.app=u}();